{"pageProps":{"metadata":{"title":"Nomad Jobspec Platform | Integrations"},"product":{"name":"Waypoint","slug":"waypoint","algoliaConfig":{"indexName":"product_WAYPOINT","searchOnlyApiKey":"5e4adfd8094367056501547d6fedb6c5"},"analyticsConfig":{"includedDomains":"waypointproject.io www.waypointproject.io","segmentWriteKey":"9mlIVayJbNtJW2EOdAFKHNKcdLAgEDlV"},"metadata":{"title":"Waypoint by HashiCorp","description":"Waypoint provides a modern workflow for build, deploy, and release across platforms.","image":"https://www.waypointproject.io/waypoint-public/img/og-image.png","icon":[{"href":"/waypoint-public/_favicon.ico"}]},"alertBannerActive":true,"alertBanner":{"tag":"HashiConf","url":"https://hashiconf.com/2023?utm_source=direct&utm_medium=banner&utm_campaign=23Q3_HASHICONFGLOBAL_EVENT&utm_content=&utm_offer=event","text":"Our community conference is taking place in San Francisco and online October 10-12.","linkText":"Register now","expirationDate":""},"subnavItems":[{"text":"Overview","url":"/","type":"inbound"},{"text":"Tutorials","url":"https://developer.hashicorp.com/waypoint/tutorials","type":"inbound"},{"text":"Docs","url":"https://developer.hashicorp.com/waypoint/docs","type":"inbound"},{"text":"CLI","url":"https://developer.hashicorp.com/waypoint/commands","type":"inbound"},{"text":"Integrations","url":"https://developer.hashicorp.com/waypoint/integrations","type":"inbound"},{"text":"Community","url":"/community","type":"inbound"}],"basePaths":["commands","docs","plugins","tutorials","downloads"],"rootDocsPaths":[{"iconName":"docs","name":"Documentation","path":"docs","includeMDXSource":true},{"iconName":"api","name":"API","path":"api-docs"},{"iconName":"terminal-screen","name":"CLI","path":"commands"}],"integrationsConfig":{"description":"A curated collection of official, partner, and community Waypoint Integrations."}},"integration":{"id":"3a474e73-0e24-4611-ad66-e9090af9443c","slug":"nomad-jobspec","name":"Nomad Jobspec","description":"The Nomad Jobspec plugin deploys to a Nomad cluster from a pre-existing Nomad job specification file.","license_type":"MPL-2.0","license_url":"https://github.com/hashicorp/waypoint/blob/main/LICENSE","external_only":false,"external_url":null,"tier":"official","repo_url":"https://github.com/hashicorp/waypoint","subdirectory":"/builtin/nomad/jobspec","created_at":"2023-02-03T18:34:01.144Z","updated_at":"2023-02-03T18:42:36.206Z","hide_versions":false,"organization":{"id":"a4a0551a-1451-4d89-9f56-8031c8350c77","slug":"hashicorp","created_at":"2022-11-09T22:56:32.391Z","updated_at":"2022-11-09T22:56:32.391Z"},"product":{"id":"68c85272-e2bf-4330-aa43-4ce4e6d899ee","slug":"waypoint","name":"Waypoint","created_at":"2022-11-09T22:56:30.388Z","updated_at":"2022-11-09T22:56:30.388Z"},"versions":["0.11.0"],"components":[{"id":"eaf5a966-8a56-4b75-a76f-f40c874037de","slug":"platform","name":"Platform","plural_name":"Platforms"}],"flags":[{"id":"d2a85dd2-1cca-4ce9-8f88-fef3c8dd0510","slug":"builtin","name":"Built-in","description":"This integration is shipped in the core product and does not need to be installed.","created_at":"2022-11-09T22:56:30.770Z","updated_at":"2023-01-27T18:33:54.665Z"}],"integration_type":null},"activeRelease":{"id":"7d44ea34-00f0-43cf-8244-f48f6c0bef89","integration_id":"3a474e73-0e24-4611-ad66-e9090af9443c","version":"0.11.0","readme":"The Nomad Jobspec plugin deploys to a Nomad cluster from a pre-existing [Nomad](https://www.nomadproject.io/)\njob specification file.\n\n### Components\n\n1. [Platform](/waypoint/integrations/hashicorp/nomad-jobspec/latest/components/platform/nomad-jobspec-platform)\n\n### Related Plugins\n\n1. [Docker](/waypoint/integrations/hashicorp/docker)\n2. [Nomad Jobspec Canary](/waypoint/integrations/hashicorp/nomad-jobspec-canary)\n\n### Resources\n\n1. Nomad Job\n","created_at":"2023-02-13T19:44:23.060Z","updated_at":"2023-04-04T18:44:53.154Z","components":[{"id":"caf0a96a-f2b1-46a0-8aef-b8137e3b4591","integration_release_id":"7d44ea34-00f0-43cf-8244-f48f6c0bef89","component_id":"eaf5a966-8a56-4b75-a76f-f40c874037de","readme":"<!-- This file was generated via `make gen/integrations-hcl` -->\nDeploy to a Nomad cluster from a pre-existing Nomad job specification file.\n\nThis plugin lets you use any pre-existing Nomad job specification file to\ndeploy to Nomad. This deployment is able to support all the features of Waypoint.\nYou may use Waypoint's [templating features](/waypoint/docs/waypoint-hcl/functions/template)\nto template the Nomad jobspec with information such as the artifact from\na previous build step, entrypoint environment variables, etc.\n\n### Artifact Access\n\nYou may use Waypoint's [templating features](/waypoint/docs/waypoint-hcl/functions/template)\nto access information such as the artifact from the build or push stages.\nAn example below shows this by using `templatefile` mixed with\nvariables such as `artifact.image` to dynamically configure the\nDocker image within the Nomad job specification.\n\n-> **Note:** If using [Nomad interpolation](/nomad/docs/runtime/interpolation) in your jobspec file,\nand the `templatefile` function in your waypoint.hcl file, any interpolated values must be escaped with a second \n`$`. For example: `$${meta.metadata}` instead of `${meta.metadata}`.\n\n### Entrypoint Functionality\n\nWaypoint [entrypoint functionality](/waypoint/docs/entrypoint#functionality) such\nas logs, exec, app configuration, and more require two properties to be true:\n\n1. The running image must already have the Waypoint entrypoint installed\n  and configured as the entrypoint. This should happen in the build stage.\n\n2. Proper environment variables must be set so the entrypoint knows how\n  to communicate to the Waypoint server. **This step happens in this\n  deployment stage.**\n\n**Step 2 does not happen automatically.** You must manually set the entrypoint\nenvironment variables using the [templating feature](/waypoint/docs/waypoint-hcl/functions/template).\nOne of the examples below shows the entrypoint environment variables being\ninjected.\n\n-> **Note:** The Waypoint entrypoint and the [Nomad entrypoint functionality](/nomad/docs/drivers/docker#entrypoint) \ncannot be used simultaneously. In order to use the features of the Waypoint entrypoint, the Nomad entrypoint must not be used in your jobspec.\n\n### URL Service\n\nIf you want your workload to be accessible by the\n[Waypoint URL service](/waypoint/docs/url), you must set the PORT environment variable\nwithin your job and be using the Waypoint entrypoint (documented in the\nprevious section).\n\nThe PORT environment variable should be the port that your web service\nis listening on that the URL service will connect to. See one of the examples\nbelow for more details.\n\n### Interface\n\n- Input: **docker.Image**\n- Output: **jobspec.Deployment**\n\n### Examples\n\n```hcl\n// The waypoint.hcl file\ndeploy {\n  use \"nomad-jobspec\" {\n    // Templated to perhaps bring in the artifact from a previous\n    // build/registry, entrypoint env vars, etc.\n    jobspec = templatefile(\"${path.app}/app.nomad.tpl\")\n  }\n}\n\n// The app.nomad.tpl file\njob \"web\" {\n  datacenters = [\"dc1\"]\n\n  group \"app\" {\n    task \"app\" {\n      driver = \"docker\"\n\n      config {\n        image = \"${artifact.image}:${artifact.tag}\"\n      }\n\n      env {\n        %{ for k,v in entrypoint.env ~}\n        ${k} = \"${v}\"\n        %{ endfor ~}\n\n        // Ensure we set PORT for the URL service. This is only necessary\n        // if we want the URL service to function.\n        PORT = 3000\n      }\n    }\n  }\n}\n```\n\n","created_at":"2023-03-14T21:14:01.415Z","updated_at":"2023-03-14T21:14:01.415Z","name":"Nomad Jobspec Platform","slug":"nomad-jobspec-platform","component":{"id":"eaf5a966-8a56-4b75-a76f-f40c874037de","slug":"platform","name":"Platform","plural_name":"Platforms","product_id":"68c85272-e2bf-4330-aa43-4ce4e6d899ee","created_at":"2022-11-09T22:56:31.464Z","updated_at":"2022-11-09T22:56:31.464Z"},"variable_groups":[{"id":"faee54fd-2734-4ad7-9b82-7cbac24426e3","created_at":"2023-03-14T21:14:01.790Z","updated_at":"2023-03-14T21:14:01.790Z","integration_release_component_id":"caf0a96a-f2b1-46a0-8aef-b8137e3b4591","variable_group_config":{"id":"263c5c35-8751-466c-aa7a-7f1a76973bd6","product_id":"68c85272-e2bf-4330-aa43-4ce4e6d899ee","name":"Parameters","filename":"parameters.hcl","stanza":"parameter","display_order":1,"created_at":"2022-12-06T21:05:38.246Z","updated_at":"2022-12-06T21:05:38.246Z"},"variables":[{"id":"8004f580-89ee-4cb6-b263-836b1c037515","variable_group_id":"faee54fd-2734-4ad7-9b82-7cbac24426e3","key":"consul_token","description":"The Consul ACL token used to register services with the Nomad job.\nUses the runner config environment variable CONSUL_HTTP_TOKEN.","type":null,"required":true,"default_value":null,"created_at":"2023-03-14T21:14:02.080Z","updated_at":"2023-03-14T21:14:02.080Z"},{"id":"044ea6db-59c1-4cc7-81e6-6eecd4fd9705","variable_group_id":"faee54fd-2734-4ad7-9b82-7cbac24426e3","key":"hcl1","description":"Parses jobspec as HCL1 instead of HCL2.","type":"bool","required":false,"default_value":"false","created_at":"2023-03-14T21:14:02.206Z","updated_at":"2023-03-14T21:14:02.206Z"},{"id":"1cdc0dcd-aaf3-4243-a810-21da1c8c3304","variable_group_id":"faee54fd-2734-4ad7-9b82-7cbac24426e3","key":"jobspec","description":"Path to a Nomad job specification file.","type":"string","required":true,"default_value":null,"created_at":"2023-03-14T21:14:02.319Z","updated_at":"2023-03-14T21:14:02.319Z"},{"id":"48bf810e-e5d5-4e26-85be-e3b5fbbf9f1a","variable_group_id":"faee54fd-2734-4ad7-9b82-7cbac24426e3","key":"vault_token","description":"The Vault token used to deploy the Nomad job with a token having specific Vault policies attached.\nUses the runner config environment variable VAULT_TOKEN.","type":null,"required":true,"default_value":null,"created_at":"2023-03-14T21:14:02.507Z","updated_at":"2023-03-14T21:14:02.507Z"}]},{"id":"b09eddee-28f3-4cd4-8cf4-69e1979ae500","created_at":"2023-03-14T21:14:02.786Z","updated_at":"2023-03-14T21:14:02.786Z","integration_release_component_id":"caf0a96a-f2b1-46a0-8aef-b8137e3b4591","variable_group_config":{"id":"917f7cae-7d3e-426c-97e0-cbbda32a6d5a","product_id":"68c85272-e2bf-4330-aa43-4ce4e6d899ee","name":"Outputs","filename":"outputs.hcl","stanza":"output","display_order":2,"created_at":"2022-12-06T21:05:38.392Z","updated_at":"2022-12-06T21:05:38.392Z"},"variables":[{"id":"06ecc77a-814d-4808-a41f-0bab20778c7e","variable_group_id":"b09eddee-28f3-4cd4-8cf4-69e1979ae500","key":"id","description":null,"type":"string","required":null,"default_value":null,"created_at":"2023-03-14T21:14:02.999Z","updated_at":"2023-03-14T21:14:02.999Z"},{"id":"16a3a5db-fcfd-4a9d-b5a7-87d218baa83e","variable_group_id":"b09eddee-28f3-4cd4-8cf4-69e1979ae500","key":"name","description":null,"type":"string","required":null,"default_value":null,"created_at":"2023-03-14T21:14:03.326Z","updated_at":"2023-03-14T21:14:03.326Z"},{"id":"01ff9aa5-122d-4eb2-a823-f1476432c60c","variable_group_id":"b09eddee-28f3-4cd4-8cf4-69e1979ae500","key":"resource_state","description":null,"type":"opaqueany.Any","required":null,"default_value":null,"created_at":"2023-03-14T21:14:03.590Z","updated_at":"2023-03-14T21:14:03.590Z"}]}]}]},"component":{"id":"caf0a96a-f2b1-46a0-8aef-b8137e3b4591","integration_release_id":"7d44ea34-00f0-43cf-8244-f48f6c0bef89","component_id":"eaf5a966-8a56-4b75-a76f-f40c874037de","readme":"<!-- This file was generated via `make gen/integrations-hcl` -->\nDeploy to a Nomad cluster from a pre-existing Nomad job specification file.\n\nThis plugin lets you use any pre-existing Nomad job specification file to\ndeploy to Nomad. This deployment is able to support all the features of Waypoint.\nYou may use Waypoint's [templating features](/waypoint/docs/waypoint-hcl/functions/template)\nto template the Nomad jobspec with information such as the artifact from\na previous build step, entrypoint environment variables, etc.\n\n### Artifact Access\n\nYou may use Waypoint's [templating features](/waypoint/docs/waypoint-hcl/functions/template)\nto access information such as the artifact from the build or push stages.\nAn example below shows this by using `templatefile` mixed with\nvariables such as `artifact.image` to dynamically configure the\nDocker image within the Nomad job specification.\n\n-> **Note:** If using [Nomad interpolation](/nomad/docs/runtime/interpolation) in your jobspec file,\nand the `templatefile` function in your waypoint.hcl file, any interpolated values must be escaped with a second \n`$`. For example: `$${meta.metadata}` instead of `${meta.metadata}`.\n\n### Entrypoint Functionality\n\nWaypoint [entrypoint functionality](/waypoint/docs/entrypoint#functionality) such\nas logs, exec, app configuration, and more require two properties to be true:\n\n1. The running image must already have the Waypoint entrypoint installed\n  and configured as the entrypoint. This should happen in the build stage.\n\n2. Proper environment variables must be set so the entrypoint knows how\n  to communicate to the Waypoint server. **This step happens in this\n  deployment stage.**\n\n**Step 2 does not happen automatically.** You must manually set the entrypoint\nenvironment variables using the [templating feature](/waypoint/docs/waypoint-hcl/functions/template).\nOne of the examples below shows the entrypoint environment variables being\ninjected.\n\n-> **Note:** The Waypoint entrypoint and the [Nomad entrypoint functionality](/nomad/docs/drivers/docker#entrypoint) \ncannot be used simultaneously. In order to use the features of the Waypoint entrypoint, the Nomad entrypoint must not be used in your jobspec.\n\n### URL Service\n\nIf you want your workload to be accessible by the\n[Waypoint URL service](/waypoint/docs/url), you must set the PORT environment variable\nwithin your job and be using the Waypoint entrypoint (documented in the\nprevious section).\n\nThe PORT environment variable should be the port that your web service\nis listening on that the URL service will connect to. See one of the examples\nbelow for more details.\n\n### Interface\n\n- Input: **docker.Image**\n- Output: **jobspec.Deployment**\n\n### Examples\n\n```hcl\n// The waypoint.hcl file\ndeploy {\n  use \"nomad-jobspec\" {\n    // Templated to perhaps bring in the artifact from a previous\n    // build/registry, entrypoint env vars, etc.\n    jobspec = templatefile(\"${path.app}/app.nomad.tpl\")\n  }\n}\n\n// The app.nomad.tpl file\njob \"web\" {\n  datacenters = [\"dc1\"]\n\n  group \"app\" {\n    task \"app\" {\n      driver = \"docker\"\n\n      config {\n        image = \"${artifact.image}:${artifact.tag}\"\n      }\n\n      env {\n        %{ for k,v in entrypoint.env ~}\n        ${k} = \"${v}\"\n        %{ endfor ~}\n\n        // Ensure we set PORT for the URL service. This is only necessary\n        // if we want the URL service to function.\n        PORT = 3000\n      }\n    }\n  }\n}\n```\n\n","created_at":"2023-03-14T21:14:01.415Z","updated_at":"2023-03-14T21:14:01.415Z","name":"Nomad Jobspec Platform","slug":"nomad-jobspec-platform","component":{"id":"eaf5a966-8a56-4b75-a76f-f40c874037de","slug":"platform","name":"Platform","plural_name":"Platforms","product_id":"68c85272-e2bf-4330-aa43-4ce4e6d899ee","created_at":"2022-11-09T22:56:31.464Z","updated_at":"2022-11-09T22:56:31.464Z"},"variable_groups":[{"id":"faee54fd-2734-4ad7-9b82-7cbac24426e3","created_at":"2023-03-14T21:14:01.790Z","updated_at":"2023-03-14T21:14:01.790Z","integration_release_component_id":"caf0a96a-f2b1-46a0-8aef-b8137e3b4591","variable_group_config":{"id":"263c5c35-8751-466c-aa7a-7f1a76973bd6","product_id":"68c85272-e2bf-4330-aa43-4ce4e6d899ee","name":"Parameters","filename":"parameters.hcl","stanza":"parameter","display_order":1,"created_at":"2022-12-06T21:05:38.246Z","updated_at":"2022-12-06T21:05:38.246Z"},"variables":[{"id":"8004f580-89ee-4cb6-b263-836b1c037515","variable_group_id":"faee54fd-2734-4ad7-9b82-7cbac24426e3","key":"consul_token","description":"The Consul ACL token used to register services with the Nomad job.\nUses the runner config environment variable CONSUL_HTTP_TOKEN.","type":null,"required":true,"default_value":null,"created_at":"2023-03-14T21:14:02.080Z","updated_at":"2023-03-14T21:14:02.080Z"},{"id":"044ea6db-59c1-4cc7-81e6-6eecd4fd9705","variable_group_id":"faee54fd-2734-4ad7-9b82-7cbac24426e3","key":"hcl1","description":"Parses jobspec as HCL1 instead of HCL2.","type":"bool","required":false,"default_value":"false","created_at":"2023-03-14T21:14:02.206Z","updated_at":"2023-03-14T21:14:02.206Z"},{"id":"1cdc0dcd-aaf3-4243-a810-21da1c8c3304","variable_group_id":"faee54fd-2734-4ad7-9b82-7cbac24426e3","key":"jobspec","description":"Path to a Nomad job specification file.","type":"string","required":true,"default_value":null,"created_at":"2023-03-14T21:14:02.319Z","updated_at":"2023-03-14T21:14:02.319Z"},{"id":"48bf810e-e5d5-4e26-85be-e3b5fbbf9f1a","variable_group_id":"faee54fd-2734-4ad7-9b82-7cbac24426e3","key":"vault_token","description":"The Vault token used to deploy the Nomad job with a token having specific Vault policies attached.\nUses the runner config environment variable VAULT_TOKEN.","type":null,"required":true,"default_value":null,"created_at":"2023-03-14T21:14:02.507Z","updated_at":"2023-03-14T21:14:02.507Z"}]},{"id":"b09eddee-28f3-4cd4-8cf4-69e1979ae500","created_at":"2023-03-14T21:14:02.786Z","updated_at":"2023-03-14T21:14:02.786Z","integration_release_component_id":"caf0a96a-f2b1-46a0-8aef-b8137e3b4591","variable_group_config":{"id":"917f7cae-7d3e-426c-97e0-cbbda32a6d5a","product_id":"68c85272-e2bf-4330-aa43-4ce4e6d899ee","name":"Outputs","filename":"outputs.hcl","stanza":"output","display_order":2,"created_at":"2022-12-06T21:05:38.392Z","updated_at":"2022-12-06T21:05:38.392Z"},"variables":[{"id":"06ecc77a-814d-4808-a41f-0bab20778c7e","variable_group_id":"b09eddee-28f3-4cd4-8cf4-69e1979ae500","key":"id","description":null,"type":"string","required":null,"default_value":null,"created_at":"2023-03-14T21:14:02.999Z","updated_at":"2023-03-14T21:14:02.999Z"},{"id":"16a3a5db-fcfd-4a9d-b5a7-87d218baa83e","variable_group_id":"b09eddee-28f3-4cd4-8cf4-69e1979ae500","key":"name","description":null,"type":"string","required":null,"default_value":null,"created_at":"2023-03-14T21:14:03.326Z","updated_at":"2023-03-14T21:14:03.326Z"},{"id":"01ff9aa5-122d-4eb2-a823-f1476432c60c","variable_group_id":"b09eddee-28f3-4cd4-8cf4-69e1979ae500","key":"resource_state","description":null,"type":"opaqueany.Any","required":null,"default_value":null,"created_at":"2023-03-14T21:14:03.590Z","updated_at":"2023-03-14T21:14:03.590Z"}]}]},"processedVariablesMarkdown":{"faee54fd-2734-4ad7-9b82-7cbac24426e3.consul_token":{"description":{"compiledSource":"var y=Object.defineProperty,m=Object.defineProperties;var l=Object.getOwnPropertyDescriptors;var s=Object.getOwnPropertySymbols;var a=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable;var p=(e,o,t)=>o in e?y(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,r=(e,o)=>{for(var t in o||(o={}))a.call(o,t)&&p(e,t,o[t]);if(s)for(var t of s(o))u.call(o,t)&&p(e,t,o[t]);return e},i=(e,o)=>m(e,l(o));var c=(e,o)=>{var t={};for(var n in e)a.call(e,n)&&o.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&s)for(var n of s(e))o.indexOf(n)<0&&u.call(e,n)&&(t[n]=e[n]);return t};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(t){var n=t,{components:e}=n,o=c(n,[\"components\"]);return mdx(MDXLayout,i(r(r({},layoutProps),o),{components:e,mdxType:\"MDXLayout\"}),mdx(\"p\",r({},{className:\"g-type-long-body\"}),`The Consul ACL token used to register services with the Nomad job.\nUses the runner config environment variable CONSUL_HTTP_TOKEN.`))}MDXContent.isMDXComponent=!0;\n","scope":{}}},"faee54fd-2734-4ad7-9b82-7cbac24426e3.hcl1":{"description":{"compiledSource":"var D=Object.defineProperty,L=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var s=Object.getOwnPropertySymbols;var p=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;var u=(o,t,n)=>t in o?D(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,a=(o,t)=>{for(var n in t||(t={}))p.call(t,n)&&u(o,n,t[n]);if(s)for(var n of s(t))r.call(t,n)&&u(o,n,t[n]);return o},y=(o,t)=>L(o,M(t));var c=(o,t)=>{var n={};for(var e in o)p.call(o,e)&&t.indexOf(e)<0&&(n[e]=o[e]);if(o!=null&&s)for(var e of s(o))t.indexOf(e)<0&&r.call(o,e)&&(n[e]=o[e]);return n};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(n){var e=n,{components:o}=e,t=c(e,[\"components\"]);return mdx(MDXLayout,y(a(a({},layoutProps),t),{components:o,mdxType:\"MDXLayout\"}),mdx(\"p\",a({},{className:\"g-type-long-body\"}),\"Parses jobspec as HCL1 instead of HCL2.\"))}MDXContent.isMDXComponent=!0;\n","scope":{}}},"faee54fd-2734-4ad7-9b82-7cbac24426e3.jobspec":{"description":{"compiledSource":"var r=Object.defineProperty,m=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var e=Object.getOwnPropertySymbols;var s=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable;var u=(o,t,n)=>t in o?r(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,p=(o,t)=>{for(var n in t||(t={}))s.call(t,n)&&u(o,n,t[n]);if(e)for(var n of e(t))c.call(t,n)&&u(o,n,t[n]);return o},y=(o,t)=>m(o,D(t));var i=(o,t)=>{var n={};for(var a in o)s.call(o,a)&&t.indexOf(a)<0&&(n[a]=o[a]);if(o!=null&&e)for(var a of e(o))t.indexOf(a)<0&&c.call(o,a)&&(n[a]=o[a]);return n};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(n){var a=n,{components:o}=a,t=i(a,[\"components\"]);return mdx(MDXLayout,y(p(p({},layoutProps),t),{components:o,mdxType:\"MDXLayout\"}),mdx(\"p\",p({},{className:\"g-type-long-body\"}),\"Path to a Nomad job specification file.\"))}MDXContent.isMDXComponent=!0;\n","scope":{}}},"faee54fd-2734-4ad7-9b82-7cbac24426e3.vault_token":{"description":{"compiledSource":"var l=Object.defineProperty,y=Object.defineProperties;var d=Object.getOwnPropertyDescriptors;var a=Object.getOwnPropertySymbols;var s=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;var u=(t,e,o)=>e in t?l(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,p=(t,e)=>{for(var o in e||(e={}))s.call(e,o)&&u(t,o,e[o]);if(a)for(var o of a(e))i.call(e,o)&&u(t,o,e[o]);return t},c=(t,e)=>y(t,d(e));var r=(t,e)=>{var o={};for(var n in t)s.call(t,n)&&e.indexOf(n)<0&&(o[n]=t[n]);if(t!=null&&a)for(var n of a(t))e.indexOf(n)<0&&i.call(t,n)&&(o[n]=t[n]);return o};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(o){var n=o,{components:t}=n,e=r(n,[\"components\"]);return mdx(MDXLayout,c(p(p({},layoutProps),e),{components:t,mdxType:\"MDXLayout\"}),mdx(\"p\",p({},{className:\"g-type-long-body\"}),`The Vault token used to deploy the Nomad job with a token having specific Vault policies attached.\nUses the runner config environment variable VAULT_TOKEN.`))}MDXContent.isMDXComponent=!0;\n","scope":{}}},"b09eddee-28f3-4cd4-8cf4-69e1979ae500.id":{},"b09eddee-28f3-4cd4-8cf4-69e1979ae500.name":{},"b09eddee-28f3-4cd4-8cf4-69e1979ae500.resource_state":{}},"anchorLinks":[{"id":"artifact-access","level":3,"title":"Artifact Access"},{"id":"entrypoint-functionality","level":3,"title":"Entrypoint Functionality"},{"id":"url-service","level":3,"title":"URL Service"},{"id":"interface","level":3,"title":"Interface"},{"id":"examples","level":3,"title":"Examples"}],"serializedREADME":{"compiledSource":"var l=Object.defineProperty,N=Object.defineProperties;var u=Object.getOwnPropertyDescriptors;var p=Object.getOwnPropertySymbols;var o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;var c=(e,n,t)=>n in e?l(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,a=(e,n)=>{for(var t in n||(n={}))o.call(n,t)&&c(e,t,n[t]);if(p)for(var t of p(n))i.call(n,t)&&c(e,t,n[t]);return e},r=(e,n)=>N(e,u(n));var m=(e,n)=>{var t={};for(var s in e)o.call(e,s)&&n.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&p)for(var s of p(e))n.indexOf(s)<0&&i.call(e,s)&&(t[s]=e[s]);return t};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(t){var s=t,{components:e}=s,n=m(s,[\"components\"]);return mdx(MDXLayout,r(a(a({},layoutProps),n),{components:e,mdxType:\"MDXLayout\"}),mdx(\"p\",a({},{className:\"g-type-long-body\"}),\"Deploy to a Nomad cluster from a pre-existing Nomad job specification file.\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),`This plugin lets you use any pre-existing Nomad job specification file to\ndeploy to Nomad. This deployment is able to support all the features of Waypoint.\nYou may use Waypoint's `,mdx(\"a\",a({parentName:\"p\"},{href:\"/waypoint/docs/waypoint-hcl/functions/template\"}),\"templating features\"),`\nto template the Nomad jobspec with information such as the artifact from\na previous build step, entrypoint environment variables, etc.`),mdx(\"h3\",a({},{id:\"user-content-artifact-access\",\"data-text-content\":\"Artifact Access\",className:\"g-type-display-4\"}),\"Artifact Access\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),\"You may use Waypoint's \",mdx(\"a\",a({parentName:\"p\"},{href:\"/waypoint/docs/waypoint-hcl/functions/template\"}),\"templating features\"),`\nto access information such as the artifact from the build or push stages.\nAn example below shows this by using `,mdx(\"inlineCode\",{parentName:\"p\"},\"templatefile\"),` mixed with\nvariables such as `,mdx(\"inlineCode\",{parentName:\"p\"},\"artifact.image\"),` to dynamically configure the\nDocker image within the Nomad job specification.`),mdx(\"div\",a({},{className:\"alert alert-info g-type-body\"}),mdx(\"p\",a({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"Note:\"),\" If using \",mdx(\"a\",a({parentName:\"p\"},{href:\"/nomad/docs/runtime/interpolation\"}),\"Nomad interpolation\"),` in your jobspec file,\nand the `,mdx(\"inlineCode\",{parentName:\"p\"},\"templatefile\"),` function in your waypoint.hcl file, any interpolated values must be escaped with a second\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"$\"),\". For example: \",mdx(\"inlineCode\",{parentName:\"p\"},\"$${meta.metadata}\"),\" instead of \",mdx(\"inlineCode\",{parentName:\"p\"},\"${meta.metadata}\"),\".\")),mdx(\"h3\",a({},{id:\"user-content-entrypoint-functionality\",\"data-text-content\":\"Entrypoint Functionality\",className:\"g-type-display-4\"}),\"Entrypoint Functionality\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),\"Waypoint \",mdx(\"a\",a({parentName:\"p\"},{href:\"/waypoint/docs/entrypoint#functionality\"}),\"entrypoint functionality\"),` such\nas logs, exec, app configuration, and more require two properties to be true:`),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",a({parentName:\"li\"},{className:\"g-type-long-body\"}),`The running image must already have the Waypoint entrypoint installed\nand configured as the entrypoint. This should happen in the build stage.`)),mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",a({parentName:\"li\"},{className:\"g-type-long-body\"}),`Proper environment variables must be set so the entrypoint knows how\nto communicate to the Waypoint server. `,mdx(\"strong\",{parentName:\"p\"},`This step happens in this\ndeployment stage.`)))),mdx(\"p\",a({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"Step 2 does not happen automatically.\"),` You must manually set the entrypoint\nenvironment variables using the `,mdx(\"a\",a({parentName:\"p\"},{href:\"/waypoint/docs/waypoint-hcl/functions/template\"}),\"templating feature\"),`.\nOne of the examples below shows the entrypoint environment variables being\ninjected.`),mdx(\"div\",a({},{className:\"alert alert-info g-type-body\"}),mdx(\"p\",a({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"Note:\"),\" The Waypoint entrypoint and the \",mdx(\"a\",a({parentName:\"p\"},{href:\"/nomad/docs/drivers/docker#entrypoint\"}),\"Nomad entrypoint functionality\"),`\ncannot be used simultaneously. In order to use the features of the Waypoint entrypoint, the Nomad entrypoint must not be used in your jobspec.`)),mdx(\"h3\",a({},{id:\"user-content-url-service\",\"data-text-content\":\"URL Service\",className:\"g-type-display-4\"}),\"URL Service\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),`If you want your workload to be accessible by the\n`,mdx(\"a\",a({parentName:\"p\"},{href:\"/waypoint/docs/url\"}),\"Waypoint URL service\"),`, you must set the PORT environment variable\nwithin your job and be using the Waypoint entrypoint (documented in the\nprevious section).`),mdx(\"p\",a({},{className:\"g-type-long-body\"}),`The PORT environment variable should be the port that your web service\nis listening on that the URL service will connect to. See one of the examples\nbelow for more details.`),mdx(\"h3\",a({},{id:\"user-content-interface\",\"data-text-content\":\"Interface\",className:\"g-type-display-4\"}),\"Interface\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"Input: \",mdx(\"strong\",{parentName:\"li\"},\"docker.Image\")),mdx(\"li\",{parentName:\"ul\"},\"Output: \",mdx(\"strong\",{parentName:\"li\"},\"jobspec.Deployment\"))),mdx(\"h3\",a({},{id:\"user-content-examples\",\"data-text-content\":\"Examples\",className:\"g-type-display-4\"}),\"Examples\"),mdx(\"pre\",a({},{className:\"language-hcl\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"// The waypoint.hcl file\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"deploy\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  use \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"nomad-jobspec\"'),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"// Templated to perhaps bring in the artifact from a previous\"),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"// build/registry, entrypoint env vars, etc.\"),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"jobspec\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" templatefile(\",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"',mdx(\"span\",a({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"$\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"path\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token type variable\"}),\"app\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\")),'/app.nomad.tpl\"'),\")\",`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"// The app.nomad.tpl file\"),`\n`,\"job \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"web\"'),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"datacenters\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"dc1\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,`\n`,\"  group \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"app\"'),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    task \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"app\"'),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"driver\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"docker\"'),`\n`,`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"config\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"        \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"image\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"',mdx(\"span\",a({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"$\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),\"artifact\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"image\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\")),\":\",mdx(\"span\",a({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"$\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),\"artifact\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"tag\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\")),'\"'),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"env\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"        %\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" for k,v in entrypoint.env ~\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"        $\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\"k\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"',mdx(\"span\",a({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"$\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),\"v\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\")),'\"'),`\n`,\"        %\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" endfor ~\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"        \",mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"// Ensure we set PORT for the URL service. This is only necessary\"),`\n`,\"        \",mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"// if we want the URL service to function.\"),`\n`,\"        \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"PORT\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token number\"}),\"3000\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)))}MDXContent.isMDXComponent=!0;\n","scope":{}},"breadcrumbLinks":[{"title":"Developer","url":"/"},{"title":"Waypoint","url":"/waypoint"},{"title":"Integrations","url":"/waypoint/integrations"},{"title":"Nomad Jobspec","url":"/waypoint/integrations/hashicorp/nomad-jobspec","isCurrentPage":false},{"title":"v0.11.0","url":"/waypoint/integrations/hashicorp/nomad-jobspec/v0.11.0","isCurrentPage":false},{"title":"Components"},{"title":"Platform"},{"title":"Nomad Jobspec Platform","url":"/waypoint/integrations/hashicorp/nomad-jobspec/latest/components/platform/nomad-jobspec-platform","isCurrentPage":true}]},"__N_SSG":true}